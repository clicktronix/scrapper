"""Справочник категорий, подкатегорий и тегов для AI-анализа блогеров."""

from typing import TypedDict


class CategoryDef(TypedDict):
    code: str
    name: str
    subcategories: list[str]


# 20 верхнеуровневых категорий + подкатегории (~120 шт)
CATEGORIES: list[CategoryDef] = [
    {
        "code": "beauty",
        "name": "Красота",
        "subcategories": [
            "Макияж",
            "Уход за кожей",
            "Волосы",
            "Ногти",
            "Парфюмерия",
            "Барберинг",
            "Визажисты",
            "Стилисты",
            "Косметологи",
        ],
    },
    {
        "code": "fashion",
        "name": "Мода",
        "subcategories": [
            "Женская одежда",
            "Мужская одежда",
            "Обувь и кроссовки",
            "Аксессуары и украшения",
            "Streetwear",
            "Luxury",
            "Дизайнеры одежды",
            "Модели",
            "Имидж-консультанты",
        ],
    },
    {
        "code": "fitness",
        "name": "Фитнес и спорт",
        "subcategories": [
            "Тренировки и зал",
            "Йога и пилатес",
            "Бег",
            "Единоборства",
            "Спортивное питание",
            "Конкретные виды спорта",
            "Тренеры",
            "Спортсмены",
            "Нутрициологи",
        ],
    },
    {
        "code": "food",
        "name": "Еда и кулинария",
        "subcategories": [
            "Рецепты",
            "Рестораны и кафе",
            "ПП и диеты",
            "Выпечка",
            "Национальная кухня",
            "Веган",
            "Повара и шеф-повара",
            "Кондитеры",
        ],
    },
    {
        "code": "travel",
        "name": "Путешествия",
        "subcategories": [
            "По Казахстану",
            "СНГ",
            "Европа и мир",
            "Бюджетные",
            "Luxury-путешествия",
            "Гиды и экскурсоводы",
            "Тревел-фотографы",
        ],
    },
    {
        "code": "lifestyle",
        "name": "Лайфстайл",
        "subcategories": [
            "Повседневная жизнь",
            "Мотивация и саморазвитие",
            "Минимализм",
            "Коучи",
            "Спикеры",
        ],
    },
    {
        "code": "family",
        "name": "Семья и дети",
        "subcategories": [
            "Материнство",
            "Отцовство",
            "Беременность",
            "Детское развитие",
            "Подростки",
            "Педагоги",
            "Детские психологи",
            "Логопеды",
        ],
    },
    {
        "code": "health",
        "name": "Здоровье",
        "subcategories": [
            "Медицина",
            "Психология",
            "ЗОЖ",
            "Врачи",
            "Стоматологи",
            "Дерматологи",
            "Психотерапевты",
            "Диетологи",
            "Фармацевты",
        ],
    },
    {
        "code": "tech",
        "name": "Технологии",
        "subcategories": [
            "Гаджеты и обзоры",
            "Софт и приложения",
            "AI и нейросети",
            "IT-специалисты",
            "Разработчики",
            "Тестировщики",
        ],
    },
    {
        "code": "business",
        "name": "Бизнес",
        "subcategories": [
            "Предпринимательство",
            "Маркетинг и SMM",
            "Финансы и инвестиции",
            "Карьера",
            "Крипто",
            "Юристы",
            "Бухгалтеры",
            "HR-специалисты",
            "Риэлторы",
        ],
    },
    {
        "code": "education",
        "name": "Образование",
        "subcategories": [
            "Языки",
            "Школьное и вузы",
            "Онлайн-курсы",
            "Наука",
            "Книги",
            "Учителя",
            "Репетиторы",
            "Профессора",
        ],
    },
    {
        "code": "entertainment",
        "name": "Развлечения",
        "subcategories": [
            "Юмор и скетчи",
            "Челленджи",
            "Пранки",
            "Мемы",
            "Стендап",
            "Комики",
            "Актёры",
            "Аниматоры",
        ],
    },
    {
        "code": "music",
        "name": "Музыка",
        "subcategories": [
            "Исполнители",
            "DJ",
            "Каверы",
            "Музыкальное образование",
            "Музыканты",
            "Продюсеры",
            "Вокальные тренеры",
        ],
    },
    {
        "code": "gaming",
        "name": "Игры",
        "subcategories": [
            "Видеоигры",
            "Стриминг",
            "Киберспорт",
            "Мобильные игры",
            "Стримеры",
            "Киберспортсмены",
        ],
    },
    {
        "code": "art",
        "name": "Искусство",
        "subcategories": [
            "Фотография",
            "Живопись и иллюстрация",
            "Дизайн",
            "Кино и сериалы",
            "Танцы",
            "Фотографы",
            "Художники",
            "Графические дизайнеры",
            "Хореографы",
        ],
    },
    {
        "code": "home",
        "name": "Дом и интерьер",
        "subcategories": [
            "Дизайн интерьера",
            "Ремонт и строительство",
            "DIY",
            "Сад и огород",
            "Архитекторы",
            "Дизайнеры интерьера",
            "Прорабы",
        ],
    },
    {
        "code": "auto",
        "name": "Авто и мото",
        "subcategories": [
            "Обзоры авто",
            "Тюнинг",
            "Мотоциклы",
            "Электромобили",
            "Автомеханики",
            "Автоэксперты",
        ],
    },
    {
        "code": "pets",
        "name": "Животные",
        "subcategories": [
            "Собаки",
            "Кошки",
            "Экзотические",
            "Ветеринары",
            "Грумеры",
            "Кинологи",
        ],
    },
    {
        "code": "realestate",
        "name": "Недвижимость",
        "subcategories": [
            "Квартиры",
            "Загородное",
            "Аренда",
            "Обзоры ЖК",
            "Застройщики",
        ],
    },
    {
        "code": "esoteric",
        "name": "Эзотерика и духовность",
        "subcategories": [
            "Астрология",
            "Таро",
            "Психологические практики",
            "Религия",
            "Астрологи",
            "Тарологи",
        ],
    },
]

# 200+ тегов по 6 группам
TAGS: dict[str, list[str]] = {
    # Группа 1: Контент и формат (~40 тегов) — PRD секция 3.3
    "content": [
        # Формат контента
        "видео-контент",
        "фото-контент",
        "reels",
        "карусели",
        "сторис-контент",
        "прямые эфиры",
        "подкасты",
        "лонгриды",
        "shorts",
        # Стиль подачи
        "юмор",
        "эстетика",
        "образовательный",
        "мотивационный",
        "провокационный",
        "разговорный",
        "сторителлинг",
        "до/после",
        "обзоры",
        "ASMR",
        "влог",
        "туториалы",
        "лайфхаки",
        "рецензии",
        "интервью",
        "коллаборации",
        "челленджи",
        # Качество
        "профессиональная съёмка",
        "студийный свет",
        "мобильная съёмка",
        "монтаж",
        "анимация",
        "графика",
        "единый визуальный стиль",
        # Частота и активность
        "ежедневный постинг",
        "несколько раз в неделю",
        "еженедельный",
        "нерегулярный",
        "высокая вовлечённость аудитории",
        "активно отвечает на комментарии",
    ],
    # Группа 2: Личность и демография (~45 тегов) — PRD секция 3.4
    "personal": [
        # Пол и возраст
        "женщина",
        "мужчина",
        "18-24",
        "25-34",
        "35-44",
        "45+",
        # Семья
        "замужем/женат",
        "в отношениях",
        "мама",
        "папа",
        "мама двоих детей",
        "мама троих+",
        "многодетная семья",
        "молодая мама",
        "беременна",
        "дети-младенцы",
        "дети-школьники",
        "дети-подростки",
        # Образ жизни
        "премиум-образ жизни",
        "luxury",
        "средний класс",
        "бюджетный образ жизни",
        "минималист",
        "путешествует часто",
        "домосед",
        "активный образ жизни",
        "ЗОЖ",
        # Авто и имущество
        "автовладелец",
        "бюджетное авто",
        "премиум авто",
        "luxury авто",
        "мотоцикл",
        "владелец недвижимости",
        "арендатор",
        # Питомцы
        "собака",
        "кошка",
        "экзотические животные",
        "несколько питомцев",
        # Локация
        "Алматы",
        "Астана",
        "Шымкент",
        "Москва",
        "Дубай",
        "Стамбул",
        "живёт за границей",
        "релокант",
        "цифровой кочевник",
    ],
    # Группа 3: Профессиональное и экспертиза (~30 тегов) — PRD секция 3.5
    "professional": [
        # Статус
        "эксперт в нише",
        "сертифицированный специалист",
        "дипломированный",
        "практикующий специалист",
        "преподаватель",
        "автор курсов",
        "автор книги",
        "спикер",
        "менторство",
        # Языки
        "русский",
        "казахский",
        "английский",
        "двуязычный",
        "многоязычный",
        "постит на русском",
        "постит на казахском",
        # Управление
        "есть менеджер",
        "есть агентство",
        "самостоятельное управление",
        "есть ассистент",
        # Мультиплатформенность
        "Instagram",
        "TikTok",
        "YouTube",
        "Telegram",
        "VK",
        "мультиплатформенный",
    ],
    # Группа 4: Коммерция и реклама (~35 тегов) — PRD секция 3.6
    "commercial": [
        # Размер
        "нано (до 10K)",
        "микро (10-100K)",
        "мид (100K-500K)",
        "макро (500K-1M)",
        "мега (1M+)",
        "селебрити",
        # Рекламная активность
        "активный рекламодатель",
        "редко рекламирует",
        "не рекламирует",
        "открыт к бартеру",
        "только за оплату",
        # Форматы рекламы
        "интеграции",
        "выделенные посты",
        "сторис-реклама",
        "reels-реклама",
        "обзоры продуктов",
        "распаковки",
        "амбассадорство",
        "прямые эфиры с брендом",
        # Коммерческие индустрии (что рекламирует)
        "рекламирует косметику",
        "рекламирует одежду",
        "рекламирует еду",
        "рекламирует авто",
        "рекламирует недвижимость",
        "рекламирует банки/финтех",
        "рекламирует детские товары",
        "рекламирует путешествия",
        "рекламирует электронику",
        # Собственный продукт
        "свой бренд одежды",
        "свой курс",
        "свой магазин",
        "свой ресторан/кафе",
        "свой бьюти-салон",
        "свой мерч",
        "реферальные ссылки",
    ],
    # Группа 5: Аудитория (~25 тегов) — PRD секция 3.7
    "audience": [
        # Демография аудитории
        "аудитория женская",
        "аудитория мужская",
        "аудитория смешанная",
        "аудитория 18-24",
        "аудитория 25-34",
        "аудитория 35-44",
        "аудитория 45+",
        # Гео аудитории
        "аудитория Казахстан",
        "аудитория Россия",
        "аудитория Узбекистан",
        "аудитория СНГ",
        "аудитория международная",
        # Качество
        "органическая аудитория",
        "подозрительная активность",
        "высокая вовлечённость",
        "лояльное комьюнити",
        "положительные комментарии",
        "токсичные комментарии",
        # Доход аудитории
        "аудитория low-income",
        "аудитория middle-income",
        "аудитория high-income",
        "аудитория premium",
    ],
    # Группа 6: Маркетинговая ценность (~30 тегов) — PRD секция 3.8
    "marketing": [
        # Подходит для индустрий
        "подходит для beauty-брендов",
        "подходит для fashion",
        "подходит для FMCG",
        "подходит для tech",
        "подходит для авто",
        "подходит для банков",
        "подходит для HoReCa",
        "подходит для фарма",
        "подходит для детских брендов",
        "подходит для travel",
        "подходит для e-commerce",
        "подходит для luxury",
        # Не подходит для
        "не подходит для алкоголя",
        "не подходит для политики",
        "не подходит для азартных игр",
        "не подходит для 18+",
        "не подходит для табака",
        # Риски и репутация
        "низкий риск",
        "средний риск",
        "brand safe",
        "были скандалы",
        "спорные высказывания",
        # Ценности
        "семейные ценности",
        "экология",
        "феминизм",
        "инклюзивность",
        "благотворительность",
        "патриотизм",
        "позитив",
        "честность и прозрачность",
    ],
}


# Плоские списки для enum-ограничений в JSON-схеме (OpenAI structured outputs)
ALL_CATEGORY_CODES: list[str] = [cat["code"] for cat in CATEGORIES]
ALL_SUBCATEGORY_NAMES: list[str] = sorted({
    sub for cat in CATEGORIES for sub in cat["subcategories"]
})
ALL_TAG_NAMES: list[str] = sorted({
    tag for tags in TAGS.values() for tag in tags
})


def get_categories_for_prompt() -> str:
    """Сформировать текст категорий для system prompt."""
    lines: list[str] = []
    for cat in CATEGORIES:
        subs = ", ".join(cat["subcategories"])
        lines.append(f"- {cat['code']} ({cat['name']}): {subs}")
    return "\n".join(lines)


def get_tags_for_prompt() -> str:
    """Сформировать текст тегов для system prompt."""
    lines: list[str] = []
    for group, tags in TAGS.items():
        lines.append(f"\n{group}: {', '.join(tags)}")
    return "\n".join(lines)
